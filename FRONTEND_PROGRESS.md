# üé® Frontend Analysis: Old Vitte Project

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `old_project/vitte-main copy/`
**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2026-01-14
**–¶–µ–ª—å:** –ü–æ–ª–Ω–∞—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (Web App) –∏ —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –≤ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç

---

## üì± Web App (Miniapp) - Telegram Mini Application

### üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

#### Core
- **React 19.2.0** - Latest version —Å StrictMode
- **TypeScript 5.9.3** - –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- **Vite 7.2.2** - Build tool –∏ dev server
- **React Router DOM 7.9.6** - Client-side routing

#### Styling & UI
- **Tailwind CSS 3.4.18** - Utility-first CSS framework
- **PostCSS 8.5.6** + **Autoprefixer**
- **–ö–∞—Å—Ç–æ–º–Ω–∞—è –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞:**
  - –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ —Å —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ-—Ä–æ–∑–æ–≤—ã–º–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏
  - –¶–≤–µ—Ç–∞: `#050712` (bg-dark), `#111322` (card-dark), `#9C6BFF` (accent)
  - –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã: `from-[#7B4DF0] to-[#E44CC6]`
  - –ê–Ω–∏–º–∞—Ü–∏–∏: `chip-pulse`, `dots`, loading states

#### Build & Dev Tools
- ESLint 9.39.1 —Å React hooks plugin
- Vercel deployment configuration

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
miniapp/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.tsx                    # Entry point —Å ErrorBoundary
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx                     # Root component —Å routing
‚îÇ   ‚îú‚îÄ‚îÄ index.css                   # Global styles, Tailwind imports
‚îÇ   ‚îú‚îÄ‚îÄ App.css                     # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ pages/                      # –°—Ç—Ä–∞–Ω–∏—Ü—ã (Route components)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CharactersList.tsx      # –ì–ª–∞–≤–Ω–∞—è –≥–∞–ª–µ—Ä–µ—è ("/", "/characters")
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CharacterDetails.tsx    # –î–µ—Ç–∞–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ + –≤—ã–±–æ—Ä –∏—Å—Ç–æ—Ä–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CharacterCustom.tsx     # –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å–≤–æ–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Paywall.tsx            # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–¥–ø–∏—Å–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Store.tsx              # –ú–∞–≥–∞–∑–∏–Ω –ø–∞–∫–µ—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Settings.tsx           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PersonaCard.tsx        # –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ImageChip.tsx          # –°—Ç–∞—Ç—É—Å-—á–∏–ø –≤ —Ö–µ–¥–µ—Ä–µ (üì∑ counter + badge)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CustomHeroAvatar.tsx   # SVG –∞–≤–∞—Ç–∞—Ä –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DebugTelegramBanner.tsx # Dev mode helper
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PageHeader.tsx     # –û–±—â–∏–π —Ö–µ–¥–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ StoreLayout.tsx    # Layout –¥–ª—è Store
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ common/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ErrorBoundary.tsx  # Error handling
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.ts              # API functions (fetch wrappers)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types.ts               # TypeScript type definitions
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAccessStatus.ts     # –°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–∞/–ø–æ–¥–ø–∏—Å–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useImagesLeft.ts       # –°—á–µ—Ç—á–∏–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useStoreData.ts        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–∞–≥–∞–∑–∏–Ω–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useTrackMiniAppOpen.ts # Analytics tracking
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram.ts            # Telegram WebApp integration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegramId.ts          # Telegram ID resolution
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ avatars.ts             # Avatar path mapping
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pub.ts                 # Public asset URL helper
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ assets/                    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞—Å—Å–µ—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îî‚îÄ‚îÄ personas/                  # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
‚îÇ       ‚îú‚îÄ‚îÄ *-card.jpg             # –ê–≤–∞—Ç–∞—Ä—ã –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫
‚îÇ       ‚îú‚îÄ‚îÄ *-chat.jpg             # –ê–≤–∞—Ç–∞—Ä—ã –¥–ª—è —á–∞—Ç–∞
‚îÇ       ‚îî‚îÄ‚îÄ *-story-*.jpg          # –ü—Ä–µ–≤—å—é –∏—Å—Ç–æ—Ä–∏–π
‚îÇ
‚îú‚îÄ‚îÄ index.html                     # Entry HTML (–∑–∞–≥—Ä—É–∂–∞–µ—Ç Telegram WebApp SDK)
‚îú‚îÄ‚îÄ vite.config.ts                 # Vite –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ tailwind.config.js             # Tailwind –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ postcss.config.js              # PostCSS config
‚îî‚îÄ‚îÄ package.json                   # Dependencies
```

---

## üó∫ –†–æ—É—Ç–∏–Ω–≥ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è

### Routes (React Router)
```
/                       ‚Üí CharactersList    (–ì–ª–∞–≤–Ω–∞—è –≥–∞–ª–µ—Ä–µ—è)
/characters             ‚Üí CharactersList    (–ê–ª–∏–∞—Å –≥–ª–∞–≤–Ω–æ–π)
/characters/:id         ‚Üí CharacterDetails  (–î–µ—Ç–∞–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞)
/characters/custom      ‚Üí CharacterCustom   (–°–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–∂)
/paywall               ‚Üí Paywall           (–ü–æ–¥–ø–∏—Å–∫–∏)
/store                 ‚Üí Store             (–ú–∞–≥–∞–∑–∏–Ω)
/settings              ‚Üí Settings          (–ù–∞—Å—Ç—Ä–æ–π–∫–∏)
*                      ‚Üí 404               (Not found)
```

### –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∏—á–∏
- **Telegram Back Button** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–∞—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π "–ù–∞–∑–∞–¥"
- **Safe area insets** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã—Ä–µ–∑–æ–≤ (notch)
- **404 —Å—Ç—Ä–∞–Ω–∏—Ü–∞** —Å –∫–Ω–æ–ø–∫–æ–π "–ù–∞ –≥–ª–∞–≤–Ω—É—é"

---

## üí¨ –í–°–ï –¢–ï–ö–°–¢–´ (Russian) - –°–û–•–†–ê–ù–ò–¢–¨ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô

### CharactersList Page

**–ó–∞–≥–æ–ª–æ–≤–æ–∫:**
- `"–ü–µ—Ä—Å–æ–Ω–∞–∂–∏"`

**–ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞:**
- `"–°–≤–æ–π –≥–µ—Ä–æ–π"`
- `"–°–æ–∑–¥–∞–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"`

**–ë–µ–π–¥–∂ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:**
- `"–≤—ã–±—Ä–∞–Ω–æ"`

**–ö–Ω–æ–ø–∫–∏:**
- `"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–¥–ø–∏—Å–∫–µ"`
- `"–ú–∞–≥–∞–∑–∏–Ω"`
- `"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è"`

**–û—à–∏–±–∫–∏:**
- `"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π"`

---

### CharacterDetails Page

**–°–µ–∫—Ü–∏–∏:**
- `"–û –ø–µ—Ä—Å–æ–Ω–∞–∂–µ"`
- `"–≠–º–æ—Ü–∏–∏ –∏ —á—É–≤—Å—Ç–≤–∞"` (–∞–∫–∫–æ—Ä–¥–µ–æ–Ω)
  - `"–ß—Ç–æ –µ–π –Ω—Ä–∞–≤–∏—Ç—Å—è"`
  - `"–ß—Ç–æ —Ä–∞–Ω–∏—Ç"`
- `"–ò—Å—Ç–æ—Ä–∏–∏"`

**–¢–∏–ø—ã –∏—Å—Ç–æ—Ä–∏–π (atmosphere):**
- `"–§–ª–∏—Ä—Ç –∏ —Ä–æ–º–∞–Ω—Ç–∏–∫–∞"` ‚Üí `flirt_romance`
- `"–ü–æ–¥–¥–µ—Ä–∂–∫–∞"` ‚Üí `support`
- `"–£—é—Ç–Ω—ã–π –≤–µ—á–µ—Ä"` ‚Üí `cozy_evening`
- `"–°–µ—Ä—å—ë–∑–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä"` ‚Üí `serious_talk`

**–ö–Ω–æ–ø–∫–∏:**
- `"–í—ã–±–µ—Ä–∏ –∏—Å—Ç–æ—Ä–∏—é"` (–∏—Å—Ç–æ—Ä–∏—è –Ω–µ –≤—ã–±—Ä–∞–Ω–∞)
- `"–ù–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä"` (–Ω–æ–≤—ã–π –¥–∏–∞–ª–æ–≥)
- `"–û–±–Ω–æ–≤–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å"` (–µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è + –∏–∑–º–µ–Ω–µ–Ω–∏—è)
- `"–í—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥"` (–∑–∞–≥—Ä—É–∑–∫–∞)
- `"–°–¥–µ–ª–∞—Ç—å –æ–±—â–µ–Ω–∏–µ –ª—É—á—à–µ"` (—Å—Å—ã–ª–∫–∞ –≤ –º–∞–≥–∞–∑–∏–Ω)

**–û—à–∏–±–∫–∏:**
- `"–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏ –∏—Å—Ç–æ—Ä–∏—é"`
- `"–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–±—Ä–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"`
- `"–ü–µ—Ä—Å–æ–Ω–∞–∂ –Ω–µ –Ω–∞–π–¥–µ–Ω"`

---

### CharacterCustom Page

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
- `"–°–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–∂"`
- `"–°–æ–∑–¥–∞–π –º–µ–Ω—è"`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
```
"–ü—Ä–∏–¥—É–º–∞–π —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –ø–æ–¥ –ª—é–±–æ–µ –∂–µ–ª–∞–Ω–∏–µ: —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏–ª–∏ –≤—ã–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ, –ø–æ–ø—É–ª—è—Ä–Ω–æ–≥–æ –∞—Ä—Ç–∏—Å—Ç–∞ –∏–ª–∏ –±–ª–∏–∑–∫–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞, —Å—Ç–∞—Ä–æ–≥–æ –¥—Ä—É–≥–∞ –∏–ª–∏ –Ω–µ–∑–Ω–∞–∫–æ–º—Ü–∞, —Å –∫–æ—Ç–æ—Ä—ã–º —Ö–æ—á–µ—Ç—Å—è –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —á–µ–º-—Ç–æ –≤–∞–∂–Ω—ã–º –∏–ª–∏ –æ–±—Å—É–¥–∏—Ç—å –ª—é–±—É—é —Ç–µ–º—É. –†–∞—Å—Å–∫–∞–∂–∏, –∫–∞–∫–∏–º –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å, –∏ Vitte –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑."
```

**–§–æ—Ä–º–∞:**
- –ü–æ–ª–µ 1: `"–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"`
  - Placeholder: `"–ù–∞–ø—Ä–∏–º–µ—Ä, –°–µ—Ä–∞—Ñ–∏–Ω–∞"`
- –ü–æ–ª–µ 2: `"–ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ / –≤–∞–π–±"`
  - Placeholder: `"–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–µ—Ä–∑–∫–∞—è –∏ –∑–∞–±–æ—Ç–ª–∏–≤–∞—è –ø–æ–¥—Ä—É–≥–∞"`
- –ü–æ–ª–µ 3: `"–î–æ–ø. –≤–∞–π–± (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"`
  - Placeholder: `"–õ—é–±–∏–º—ã–µ —Ç–µ–º—ã, —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫–∏, —Ç—Ä–∏–≥–≥–µ—Ä—ã"`

**–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (Free tier):**
```
"–°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –ø–æ–¥–ø–∏—Å–∫–µ Premium."
```

**–ö–Ω–æ–ø–∫–∏:**
- `"–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"` (–µ—Å–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ)
- `"–°–æ–∑–¥–∞—Ç—å –∏ –Ω–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä"` (–Ω–æ–≤—ã–π –∫–∞—Å—Ç–æ–º–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂)
- `"–ù–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä"` (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- `"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å"` (–µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è)
- `"–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä"` (–µ—Å—Ç—å –¥–∏–∞–ª–æ–≥, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- `"–°–æ—Ö—Ä–∞–Ω—è–µ–º..."` (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏)

**–°—Ç–∞—Ç—É—Å—ã:**
- `"–ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–≤–æ–µ–≥–æ –≥–µ—Ä–æ—è..."`

---

### Paywall Page

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
- `"–ü–æ–¥–ø–∏—Å–∫–∞"`
- `"Vitte Premium"`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥–ø–∏—Å–∫–∏:**
```
‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
‚Ä¢ 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
‚Ä¢ –°–∞–º—ã–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–æ–¥–µ–ª–∏ –ò–ò
‚Ä¢ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```

**–ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞:**
```
"–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ –¥–æ ${date}. –°–ø–∞—Å–∏–±–æ, —á—Ç–æ –æ—Å—Ç–∞—ë—à—å—Å—è üíõ"
```

**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–ª–∞–Ω–∞:**
- `"${days} –¥–Ω–µ–π"`

**–ö–Ω–æ–ø–∫–∏:**
- `"–û—Ñ–æ—Ä–º–ª—è–µ–º..."` (–∑–∞–≥—Ä—É–∑–∫–∞)

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:**
```
"–ú—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Å—á—ë—Ç –≤ Telegram. –û–ø–ª–∞—Ç–∏ –µ–≥–æ –≤ —á–∞—Ç–µ –±–æ—Ç–∞."
```

---

### Store Page

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
- `"–ú–∞–≥–∞–∑–∏–Ω"`
- –°–µ–∫—Ü–∏—è: `"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
```
"–£ –≤–∞—Å ${count} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –î–æ–∫—É–ø–∏—Ç–µ –µ—â—ë ‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –ø–∞–∫–µ—Ç –Ω–∏–∂–µ."
```

**–ü–∞–∫–µ—Ç—ã:**
- –õ–µ–π–±–ª: `"${count} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"`
- –ö–Ω–æ–ø–∫–∞ –ø–æ–∫—É–ø–∫–∏: `"${price} ‚≠ê"`
- –ó–∞–≥—Ä—É–∑–∫–∞: `"–ü–æ–∫—É–ø–∞–µ–º..."`

**–§–∏—á–∏ (features):**
- –ö–Ω–æ–ø–∫–∞: `"–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å"`
- –ó–∞–≥—Ä—É–∑–∫–∞: `"–û—Ñ–æ—Ä–º–ª—è–µ–º..."`
- –°—Ç–∞—Ç—É—Å: `"–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ"` (—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ)

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:**
```
"–°—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram. –û–ø–ª–∞—Ç–∏—Ç–µ –µ–≥–æ –≤ —á–∞—Ç–µ –±–æ—Ç–∞."
```

---

### Settings Page

**–ó–∞–≥–æ–ª–æ–≤–æ–∫:**
- `"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"`

**–¢–∞–±—ã:**
- `"–ú–æ–∏ —É–ª—É—á—à–µ–Ω–∏—è"`
- `"–û—Å–Ω–æ–≤–Ω—ã–µ"`

**–ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
```
"–ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π. –ü–æ–¥–∫–ª—é—á–∏ —Ñ–∏—á–∏, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –æ–±—â–µ–Ω–∏–µ –±–æ–≥–∞—á–µ."
```

**–°–µ–∫—Ü–∏–∏:**
- `"–ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è"` (locked features)

**–¢–æ–≥–≥–ª—ã:**
- `"–í–∫–ª"` / `"–í—ã–∫–ª"`

**–î–µ–π—Å—Ç–≤–∏—è:**
- `"–û—á–∏—Å—Ç–∏—Ç—å –ø–∞–º—è—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤"`
- `"–û—á–∏—Å—Ç–∏—Ç—å –¥–æ–ª–≥—É—é –ø–∞–º—è—Ç—å"`
- `"–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç"`
- `"–í—ã–π—Ç–∏ –∏–∑ MiniApp"`

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:**
```
"–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –ø–µ—Ä–µ–ø–∏—Å–∫—É? –≠—Ç–æ —É–¥–∞–ª–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –∫—Ä–∞—Ç–∫–æ–π –ø–∞–º—è—Ç–∏."

"–û—á–∏—Å—Ç–∏—Ç—å –¥–æ–ª–≥—É—é –ø–∞–º—è—Ç—å? –í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –±—É–¥—É—Ç —Å—Ç–µ—Ä—Ç—ã."

"–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç –∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ."
```

**–°–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ:**
```
"–ö—Ä–∞—Ç–∫–∞—è –ø–∞–º—è—Ç—å –æ—á–∏—â–µ–Ω–∞."

"–î–æ–ª–≥–∞—è –ø–∞–º—è—Ç—å –æ—á–∏—â–µ–Ω–∞."

"–ê–∫–∫–∞—É–Ω—Ç —É–¥–∞–ª—ë–Ω. –ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å MiniApp."
```

**–ë–∞–Ω–Ω–µ—Ä –∞–ø–≥—Ä–µ–π–¥–∞:**
```
"–û—Ç–∫—Ä–æ–π –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø"

"–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ –∏ –≤—Å–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π."

"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–¥–ø–∏—Å–∫–µ"
```

---

### –ü—Ä–æ—á–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**Error Boundary:**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: `"–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫"`
- –ö–Ω–æ–ø–∫–∞: `"–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å"`

**404 Page:**
- –°–æ–æ–±—â–µ–Ω–∏–µ: `"–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"`
- –ö–Ω–æ–ø–∫–∞: `"–ù–∞ –≥–ª–∞–≤–Ω—É—é"`

**ImageChip:**
- Badge: `"Premium"` / `"Free"`
- Counter emoji: `"üì∑"`

**DebugTelegramBanner:**
```
"–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –±–µ–∑ Telegram –∑–∞–¥–∞–π VITE_DEBUG_TELEGRAM_ID –≤ .env."
```

---

## üé≠ –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π

### 8 –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π

#### 1. **–õ–∏–Ω–∞**
- –§–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–Ω–µ—Ä, —ç–Ω–µ—Ä–≥–∏—á–Ω–∞—è, –∫–æ–∫–µ—Ç–ª–∏–≤–∞—è
- –ò—Å—Ç–æ—Ä–∏–∏: –°–∞—É–Ω–∞, –¥—É—à —Å–ª–æ–º–∞–ª—Å—è, –Ω–æ—á–Ω–æ–π –∑–∞–ª, –ª–∏—á–Ω—ã–π —Ç—Ä–µ–Ω–µ—Ä

#### 2. **–ú–∞—Ä–∏–∞–Ω–Ω–∞**
- –î–æ–º–∏–Ω–∞–Ω—Ç–Ω–∞—è —Å–æ—Å–µ–¥–∫–∞, —Ç–æ–º–±–æ–π —Å—Ç–∏–ª—å
- –ò—Å—Ç–æ—Ä–∏–∏: –ù–æ—á–Ω–æ–µ —ç—Ö–æ, –∏–≥—Ä–∞ –Ω–∞ –¥–æ–≤–µ—Ä–∏–µ, —Ç–∞–π–Ω–∞—è –ø–æ–µ–∑–¥–∫–∞, –≤–∑—Ä–æ—Å–ª—ã–π –æ—Ç–µ–ª—å

#### 3. **–ú–µ–π**
- –ó–∞—Å—Ç–µ–Ω—á–∏–≤–∞—è –Ω–æ –≥–æ—Ç–æ–≤–∞—è, —Å–º–µ–ª—ã–µ —Å—é—Ä–ø—Ä–∏–∑—ã
- –ò—Å—Ç–æ—Ä–∏–∏: –°–∫–∞–º–µ–π–∫–∞ –≤ –¢–¶, –ø–æ–µ–∑–¥–∫–∞ –≤ –º–∞—à–∏–Ω–µ, —Ñ–µ–π—Å—Å–∏—Ç—Ç–∏–Ω–≥ –¥–æ–º–∞, —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏

#### 4. **–°—Ç–µ–π—Å–∏**
- –ò–≥—Ä–∏–≤–∞—è, —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–∞—è, –±–µ–∑ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–µ–π
- –ò—Å—Ç–æ—Ä–∏–∏: –ö—Ä—ã—à–∞ –Ω–∞ –∑–∞–∫–∞—Ç–µ, –∏–≥—Ä–∞ –≤ –Ω–∞–º—ë–∫–∏, –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ, –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –≤ –ø–∞—Ä–∫–µ

#### 5. **–Æ–Ω–∞**
- –ù–µ–∂–Ω–∞—è –∞–∑–∏–∞—Ç—Å–∫–∞—è –¥–µ–≤—É—à–∫–∞, –ø–æ—Å–ª—É—à–Ω–∞—è, —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–∞—è
- –ò—Å—Ç–æ—Ä–∏–∏: –ü–µ—Ä–≤—ã–π –≤–µ—á–µ—Ä, –≥–æ—Ä–æ–¥—Å–∫–∏–µ –æ–≥–Ω–∏, —Å–µ–∫—Ä–µ—Ç—ã –∑–∞ —á–∞–µ–º

#### 6. **–¢–∞—è**
- MILF, –∞–≤–∞–Ω—Ç—é—Ä–∏—Å—Ç–∫–∞, –∏—â–µ—Ç –æ—Å—Ç—Ä—ã—Ö –æ—â—É—â–µ–Ω–∏–π
- –ò—Å—Ç–æ—Ä–∏–∏: –í—ã—Ö–æ–¥ –∏–∑ –±–∞—Ä–∞, VIP –∏–≥—Ä–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä, –∂–µ–Ω–∞ –¥—Ä—É–≥–∞, –ª–∏—Ñ—Ç

#### 7. **–î–∂—É–ª–∏**
- –°—Ç—É–¥–µ–Ω—Ç–∫–∞ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞, –ª—é–±–æ–ø—ã—Ç–Ω–∞—è, –Ω–µ–ø–æ—Å–ª—É—à–Ω–∞—è
- –ò—Å—Ç–æ—Ä–∏–∏: –†–µ–ø–µ—Ç–∏—Ç–æ—Ä –¥–æ–º–∞, –Ω–∞–∫–∞–∑–∞–Ω–∏–µ —É—á–∏—Ç–µ–ª—è, –≤–µ—Å–µ–ª—å–µ –≤ –∞–≤—Ç–æ–±—É—Å–µ

#### 8. **–≠—à**
- –§–µ—Ç–∏—à–∏—Å—Ç–∫–∞, –ª–∞—Ç–µ–∫—Å/–∫–∞–±–ª—É–∫–∏, –¥–æ–º–∏–Ω–∞–Ω—Ç–Ω–∞—è
- –ò—Å—Ç–æ—Ä–∏–∏: –ì–æ—Å—Ç–∏–Ω–∞—è, —Å–ø–∞–ª—å–Ω—è (—Ñ–µ—Ç–∏—à —Å—Ü–µ–Ω–∞—Ä–∏–∏)

### –ü–æ–ª—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
- **name** - –ò–º—è
- **short_description** - –ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏
- **long_description** - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- **archetype** - –¢–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏
- **legend_full** - –ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è
- **emotions_full** - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å
- **triggers_positive** - –ß—Ç–æ –µ–π –Ω—Ä–∞–≤–∏—Ç—Å—è (—Å–ø–∏—Å–æ–∫)
- **triggers_negative** - –ß—Ç–æ —Ä–∞–Ω–∏—Ç (—Å–ø–∏—Å–æ–∫)
- **hooks** - –¢–µ–º—ã –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- **is_default** - –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π vs –∫–∞—Å—Ç–æ–º–Ω—ã–π
- **is_custom** - –°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- **is_active** - –í–∏–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ

### Story Cards (–ò—Å—Ç–æ—Ä–∏–∏)

**4 —Å—Ü–µ–Ω–∞—Ä–∏—è –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞** = 32+ –∏—Å—Ç–æ—Ä–∏–π –≤—Å–µ–≥–æ

**–ü–æ–ª—è Story Card:**
- **id** - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"lina_support"`)
- **key** - –ö–ª—é—á –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (`"support"`, `"flirt_romance"`, etc.)
- **title** - –ù–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ (Russian)
- **description** - –û–ø–∏—Å–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ (Russian)
- **atmosphere** - –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: `flirt_romance`, `support`, `cozy_evening`, `serious_talk`
- **prompt** - System prompt –¥–ª—è AI (Russian, –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
- **image** - –ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"personas/lina-story-support.jpg"`)

### –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂

**–î–æ—Å—Ç—É–ø:** Premium –ø–æ–¥–ø–∏—Å–∫–∞

**–§–æ—Ä–º–∞:**
- –ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
- –ö–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ / –≤–∞–π–±
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–∞–π–± (optional)

**–•—Ä–∞–Ω–µ–Ω–∏–µ:**
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î —Å `is_custom=true`
- –ü—Ä–∏–≤—è–∑–∞–Ω –∫ `owner_user_id`
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç

---

## üé® UI/UX –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### PersonaCard
```typescript
Props: {
  title: string
  description: string
  gradientVariant: "default" | "custom"
  selected: boolean
  avatarUrl?: string
  showCustomAvatar?: boolean
  onClick: () => void
}
```

**–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã:**
- `"default"` - –§–∏–æ–ª–µ—Ç–æ–≤–æ-—Ä–æ–∑–æ–≤—ã–π (purple-pink)
- `"custom"` - –°–∏–Ω–µ-—Ñ–∏–æ–ª–µ—Ç–æ–≤–æ-—Ä–æ–∑–æ–≤—ã–π (blue-purple-pink)

**–§–∏—á–∏:**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–µ–π–¥–∂ `"–≤—ã–±—Ä–∞–Ω–æ"` –µ—Å–ª–∏ `selected=true`
- –ö–∞—Å—Ç–æ–º–Ω—ã–π –∞–≤–∞—Ç–∞—Ä: –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SVG —Å–∏–ª—É—ç—Ç —Å –∑–≤–µ–∑–¥–∞–º–∏/–≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º
- Active scale: `active:scale-[0.98]`

### ImageChip
```typescript
Props: {
  imagesRemaining: number
  hasSubscription: boolean
  isPremium: boolean
  onImagesClick: () => void
  onBadgeClick: () => void
  onSettingsClick: () => void
}
```

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
- üì∑ —Å—á–µ—Ç—á–∏–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- Premium/Free badge
- –ò–∫–æ–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (—à–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞)

**–ì—Ä–∞–¥–∏–µ–Ω—Ç —Ñ–æ–Ω–∞:**
```css
from-[#2D1747] via-[#5C2D83] to-[#D64CC1]
```

### PageHeader
```typescript
Props: {
  title: string
  showBack?: boolean
  onBack?: () => void
  stats: ImageChipProps
}
```

**Layout:**
- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" (‚Üê) + –∑–∞–≥–æ–ª–æ–≤–æ–∫
- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: ImageChip —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

### CustomHeroAvatar
- SVG —Å–∏–ª—É—ç—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω —Å–æ –∑–≤–µ–∑–¥–∞–º–∏
- –†–∞–¥–∏–∞–ª—å–Ω—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–µ –Ω–∞–ª–æ–∂–µ–Ω–∏—è
- –≠—Ñ—Ñ–µ–∫—Ç –ø—É–ª—å—Å–∏—Ä—É—é—â–µ–≥–æ —Å–≤–µ—á–µ–Ω–∏—è

---

## üîó API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### Base URL
```
VITE_BACKEND_URL (env variable)
Origins: localhost:5173, vitte-pi.vercel.app
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**Header:**
```
X-Telegram-Web-App-Init-Data: <initData —Å—Ç—Ä–æ–∫–∞ –æ—Ç Telegram>
```

**Query param fallback:**
```
?telegram_id=<user_id>
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### Personas
```
GET  /api/personas                    ‚Üí –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
GET  /api/personas/:id                ‚Üí –î–µ—Ç–∞–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
POST /api/personas/:id/select         ‚Üí –í—ã–±—Ä–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (legacy)
POST /api/personas/select_and_greet   ‚Üí –í—ã–±—Ä–∞—Ç—å + –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
POST /api/personas/custom             ‚Üí –°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
```

#### Access & Store
```
GET  /api/access/status               ‚Üí –°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–∞ (–ø–æ–¥–ø–∏—Å–∫–∞, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ñ–∏—á–∏)
GET  /api/store/config                ‚Üí –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–∞–≥–∞–∑–∏–Ω–∞ (–ø–ª–∞–Ω—ã, –ø–∞–∫–µ—Ç—ã, —Ñ–∏—á–∏)
GET  /api/store/status                ‚Üí –°—Ç–∞—Ç—É—Å –º–∞–≥–∞–∑–∏–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏)
POST /api/store/buy/subscription/:code ‚Üí –ö—É–ø–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
POST /api/store/buy/image_pack/:code   ‚Üí –ö—É–ø–∏—Ç—å –ø–∞–∫–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
POST /api/store/buy/feature/:code      ‚Üí –ö—É–ø–∏—Ç—å —Ñ–∏—á—É
```

#### Features
```
GET  /api/features/status             ‚Üí –°—Ç–∞—Ç—É—Å —Ñ–∏—á
POST /api/features/toggle             ‚Üí –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —Ñ–∏—á—É
POST /api/features/clear-dialogs      ‚Üí –û—á–∏—Å—Ç–∏—Ç—å –ø–∞–º—è—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤
POST /api/features/clear-long-memory  ‚Üí –û—á–∏—Å—Ç–∏—Ç—å –¥–æ–ª–≥—É—é –ø–∞–º—è—Ç—å
POST /api/features/delete-account     ‚Üí –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
```

#### Events
```
POST /api/events/miniapp_open         ‚Üí –¢—Ä–µ–∫–∏–Ω–≥ –æ—Ç–∫—Ä—ã—Ç–∏—è miniapp
POST /api/analytics/events            ‚Üí –û–±—â–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
```

#### Chat
```
POST /api/chat                        ‚Üí –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
```

#### Bot Control
```
POST /api/bot/pay_from_miniapp        ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –±–æ—Ç–∞
```

---

## üì± Telegram WebApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### telegram.ts
```typescript
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç Telegram.WebApp
- –í—ã–∑—ã–≤–∞–µ—Ç ready() –∏ expand()
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π tg instance
```

### telegramId.ts
```typescript
–§—É–Ω–∫—Ü–∏–∏:
- resolveTelegramId(): number | undefined
  –ò—Å—Ç–æ—á–Ω–∏–∫–∏: URL param, WebApp.initDataUnsafe, initData parsing, .env fallback

- waitTelegramId(timeout): Promise<number | undefined>
- getTelegramIdOptional(): Promise<number | undefined>
- requireTelegramId(): Promise<number> (throws –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
```

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∏—á–∏ Telegram WebApp

- **`tg.BackButton`** - –ù–∞–≤–∏–≥–∞—Ü–∏—è (show/hide/onClick)
- **`tg.initDataUnsafe.start_param`** - Deep linking
- **`tg.openTelegramLink(url)`** - –û—Ç–∫—Ä—ã—Ç—å —Å—á–µ—Ç/—Å—Å—ã–ª–∫—É
- **`tg.openInvoice(url)`** - –û–ø–ª–∞—Ç–∞ (Telegram Stars)
- **`tg.close()`** - –ó–∞–∫—Ä—ã—Ç—å miniapp
- **`tg.expand()`** - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ –ø–æ–ª–Ω—É—é –≤—ã—Å–æ—Ç—É

---

## üé® –î–∏–∑–∞–π–Ω —Å–∏—Å—Ç–µ–º–∞

### –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞
```css
bg-dark: #050712
card-dark: #111322
accent: #9C6BFF
gradient-start: #7B4DF0
gradient-end: #E44CC6
```

### –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã
```css
/* Primary gradient */
from-[#7B4DF0] to-[#E44CC6]

/* Header chip gradient */
from-[#2D1747] via-[#5C2D83] to-[#D64CC1]

/* Custom persona gradient */
from-blue-500 via-purple-600 to-pink-500
```

### –ê–Ω–∏–º–∞—Ü–∏–∏
```css
chip-pulse     ‚Üí –ü—É–ª—å—Å–∞—Ü–∏—è –¥–ª—è ImageChip
dots           ‚Üí –ó–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ (...)
scale-[0.98]   ‚Üí Active state –¥–ª—è –∫–Ω–æ–ø–æ–∫
```

### –†–∞–¥–∏—É—Å—ã —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è
```css
rounded-3xl    ‚Üí 1.5rem (–±–æ–ª—å—à–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏)
rounded-4xl    ‚Üí 2rem (–æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã)
rounded-full   ‚Üí –ö–Ω–æ–ø–∫–∏, badges
```

### –¢–µ–Ω–∏
```css
shadow-lg      ‚Üí –ö–∞—Ä—Ç–æ—á–∫–∏
shadow-xl      ‚Üí –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
```

### Responsive breakpoints
```css
sm: 640px      ‚Üí Tablet
md: 768px      ‚Üí Desktop
lg: 1024px     ‚Üí Large desktop
```

---

## üîÑ State management

### Custom Hooks

#### useAccessStatus()
```typescript
Returns: {
  data: AccessStatusResponse
  loading: boolean
  error: Error | null
  reload: () => void
}

–§—É–Ω–∫—Ü–∏—è:
- Fetches —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏, —Ñ–∏—á–∏, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, paywall variant
- –ö–µ—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ
- Auto-reload –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
```

#### useImagesLeft()
```typescript
Returns: {
  imagesLeft: number
  loading: boolean
  reload: () => void
  source: "store_status" | "access_status" | "none"
}

–§—É–Ω–∫—Ü–∏—è:
- –ö–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç: store status + access status
- SessionStorage cache (TTL 120s)
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: store_status > access_status
```

#### useStoreData(auto)
```typescript
Returns: {
  config: StoreConfig
  status: StoreStatus
  loading: boolean
  error: Error | null
  reload: () => void
}

–§—É–Ω–∫—Ü–∏—è:
- Fetches –ø–ª–∞–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫, –ø–∞–∫–µ—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ü–µ–Ω—ã —Ñ–∏—á
- Auto-load –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –µ—Å–ª–∏ auto=true
```

#### useTrackMiniAppOpen()
```typescript
–§—É–Ω–∫—Ü–∏—è:
- –¢—Ä–µ–∫–∞–µ—Ç miniapp_open event —Å start_param
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é
```

---

## üí≥ –°–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã

### Telegram Stars

**–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã:**
- –ù–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram
- –û–ø–ª–∞—Ç–∞ –∑–≤–µ–∑–¥–∞–º–∏ (‚≠ê)
- –ë–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –¢–∏–ø—ã –ø–æ–∫—É–ø–æ–∫

#### 1. –ü–æ–¥–ø–∏—Å–∫–∏
```
–ü–ª–∞–Ω—ã:
- 1 –º–µ—Å—è—Ü: X ‚≠ê
- 3 –º–µ—Å—è—Ü–∞: Y ‚≠ê (—Å–∫–∏–¥–∫–∞)
- 1 –≥–æ–¥: Z ‚≠ê (–ª—É—á—à–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
‚Ä¢ 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
‚Ä¢ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ AI –º–æ–¥–µ–ª–∏
‚Ä¢ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
```

#### 2. –ü–∞–∫–µ—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```
–ü–∞–∫–µ—Ç—ã:
- 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: A ‚≠ê
- 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: B ‚≠ê
- 200 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: C ‚≠ê
```

#### 3. –§–∏—á–∏
```
intense_mode      ‚Üí –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–≥–æ/explicit –∫–æ–Ω—Ç–µ–Ω—Ç–∞
fantasy_scenes    ‚Üí –í–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–Ω—Ç–∞–∑–∏–π–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
```

### –ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã

1. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ã–∑—ã–≤–∞–µ—Ç `/api/store/buy/{type}/{code}`
2. –ë—ç–∫–µ–Ω–¥ —Å–æ–∑–¥–∞–µ—Ç Telegram Stars invoice
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `invoice_url` (`tg://invoice?...`)
4. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤ Telegram —á–µ—Ä–µ–∑ `tg.openInvoice()`
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –∑–≤–µ–∑–¥–∞–º–∏
6. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç `successful_payment` webhook
7. –ë—ç–∫–µ–Ω–¥ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É/–ø–∞–∫–µ—Ç/—Ñ–∏—á—É

---

## üîÑ User Flow (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å)

### 1. –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç miniapp –∏–∑ Telegram
2. –í–∏–¥–∏—Ç –≥–∞–ª–µ—Ä–µ—é –∏–∑ 8 –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π + –∫–∞—Å—Ç–æ–º–Ω—ã–π (–µ—Å–ª–∏ —Å–æ–∑–¥–∞–Ω)
3. –ù–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ CharacterDetails
4. –í–∏–¥–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ + 4 story cards
5. –í—ã–±–∏—Ä–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é ‚Üí –Ω–∞–∂–∏–º–∞–µ—Ç "–ù–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä"
6. API –≤—ã–∑–æ–≤: POST /api/personas/select_and_greet
7. Miniapp –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
8. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ —á–∞—Ç
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–°–≤–æ–π –≥–µ—Ä–æ–π" –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
2. –ï—Å–ª–∏ –Ω–µ—Ç Premium ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ‚Üí redirect –Ω–∞ Paywall
3. –ï—Å–ª–∏ –µ—Å—Ç—å Premium ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞
4. –ó–∞–ø–æ–ª–Ω—è–µ—Ç: –∏–º—è, –æ–ø–∏—Å–∞–Ω–∏–µ, –¥–æ–ø. –≤–∞–π–±
5. –ù–∞–∂–∏–º–∞–µ—Ç "–°–æ–∑–¥–∞—Ç—å –∏ –Ω–∞—á–∞—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä"
6. API –≤—ã–∑–æ–≤: POST /api/personas/custom
7. Miniapp –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
8. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º
```

### 3. –ü–æ–∫—É–ø–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Paywall (/paywall)
2. –í–∏–¥–∏—Ç 3 –ø–ª–∞–Ω–∞ –ø–æ–¥–ø–∏—Å–æ–∫
3. –í—ã–±–∏—Ä–∞–µ—Ç –ø–ª–∞–Ω ‚Üí –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É —Å —Ü–µ–Ω–æ–π
4. API –≤—ã–∑–æ–≤: POST /api/store/buy/subscription/:code
5. –ü–æ–ª—É—á–∞–µ—Ç invoice_url
6. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Telegram —Å invoice
7. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –∑–≤–µ–∑–¥–∞–º–∏
8. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç successful_payment
9. –ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è
10. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ miniapp ‚Üí –≤–∏–¥–∏—Ç "–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞"
```

### 4. –ü–æ–∫—É–ø–∫–∞ –ø–∞–∫–µ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Store (/store)
2. –í–∏–¥–∏—Ç —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å + –ø–∞–∫–µ—Ç—ã
3. –í—ã–±–∏—Ä–∞–µ—Ç –ø–∞–∫–µ—Ç ‚Üí –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É —Å —Ü–µ–Ω–æ–π
4. API –≤—ã–∑–æ–≤: POST /api/store/buy/image_pack/:code
5. –ü–æ–ª—É—á–∞–µ—Ç invoice_url
6. –û–ø–ª–∞—á–∏–≤–∞–µ—Ç –≤ Telegram
7. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞—á–∏—Å–ª—è—é—Ç—Å—è
8. –°—á–µ—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ñ–∏—á–∏
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Settings (/settings)
2. –í–∫–ª–∞–¥–∫–∞ "–ú–æ–∏ —É–ª—É—á—à–µ–Ω–∏—è" ‚Üí –≤–∏–¥–∏—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏—á–∏
3. –ú–æ–∂–µ—Ç –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ toggle
4. –í–∫–ª–∞–¥–∫–∞ "–û—Å–Ω–æ–≤–Ω—ã–µ" ‚Üí –¥–µ–π—Å—Ç–≤–∏—è:
   - –û—á–∏—Å—Ç–∏—Ç—å –ø–∞–º—è—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤
   - –û—á–∏—Å—Ç–∏—Ç—å –¥–æ–ª–≥—É—é –ø–∞–º—è—Ç—å
   - –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
   - –í—ã–π—Ç–∏ –∏–∑ MiniApp
```

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ —Ñ–∏—á–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### 1. –í—Å–µ —Ç–µ–∫—Å—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- **–ù–ï–õ–¨–ó–Ø –º–µ–Ω—è—Ç—å —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏**
- **–ù–ï–õ–¨–ó–Ø –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π** (–∫—Ä–æ–º–µ –±—É–¥—É—â–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏)
- –¢–æ–Ω: –ù–µ–ø—Ä–∏–Ω—É–∂–¥–µ–Ω–Ω—ã–π, —Ç–µ–ø–ª—ã–π, —Å–ª–µ–≥–∫–∞ –∏–≥—Ä–∏–≤—ã–π

### 2. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
- 8 –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –ª–∏—á–Ω–æ—Å—Ç—è–º–∏
- –ü–æ 4 –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (32+ —Å—Ü–µ–Ω–∞—Ä–∏—è)
- –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π (Premium)
- Story cards —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏ –¥–ª—è AI

### 3. Telegram Stars –æ–ø–ª–∞—Ç–∞
- –ù–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `tg.openInvoice()`
- –ü–æ–¥–ø–∏—Å–∫–∏, –ø–∞–∫–µ—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ñ–∏—á–∏
- Invoice flow: API ‚Üí Telegram ‚Üí Webhook ‚Üí –ê–∫—Ç–∏–≤–∞—Ü–∏—è

### 4. –í–∏–∑—É–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å
- –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ —Å —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ-—Ä–æ–∑–æ–≤—ã–º–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏
- –ö–∞—Ä—Ç–æ—á–Ω–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞
- –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã
- Safe area support

### 5. Telegram WebApp API
- BackButton –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- Deep linking —á–µ—Ä–µ–∑ start_param
- openInvoice –¥–ª—è –æ–ø–ª–∞—Ç—ã
- close() –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

---

## üì¶ Deployment & Build

### Frontend Build
```bash
npm install
npm run dev     # Dev server (localhost:5173)
npm run build   # Production build ‚Üí dist/
npm run preview # Preview production build
```

### Environment Variables
```bash
VITE_BACKEND_URL=https://api.example.com  # Backend API URL
VITE_DEBUG_TELEGRAM_ID=123456789          # Local dev –±–µ–∑ Telegram
```

### Vercel Configuration
```json
{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "devCommand": "npm run dev",
  "framework": "vite"
}
```

---

## üîç Backend Overview (–∫—Ä–∞—Ç–∫–æ)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **FastAPI** - Python async web framework
- **SQLAlchemy** - ORM —Å async support
- **PostgreSQL** - Database —Å enums
- **Aiogram** - Telegram bot framework

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ë–î

**Users:**
- telegram_id, username, first_name
- access_status (enum: no_access, trial_usage, subscription_active)
- free_messages_used/limit
- active_persona_id
- subscription_ends_at
- remaining_free_images_today, remaining_paid_images

**Personas:**
- name, short/long_description, gender, kind, archetype
- is_default, is_custom, is_active
- owner_user_id (FK to User)
- legend_full, emotions_full, triggers_positive/negative
- system_prompt (–¥–ª—è AI)

**Dialogs:**
- user_id, persona_id
- last_message_at, message_count
- memory fields (short/long term)

**Messages:**
- dialog_id, role (user/assistant)
- content, sent_at
- image_url (–µ—Å–ª–∏ AI-generated image)

**Products:**
- code (–Ω–∞–ø—Ä–∏–º–µ—Ä, "premium_1m", "pack_50")
- price_stars, duration_days
- is_active

**User Purchases:**
- user_id, product_code
- purchased_at, expires_at
- is_active

---

## ü§ñ Telegram Bot - –¢–µ–∫—Å—Ç—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

#### `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ

**Terms Gate (–¥–æ –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–∞–≤–∏–ª):**
```
<b>Vitte ‚Äî —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π AI-–∫–æ–º–ø–∞–Ω—å–æ–Ω 18+</b>

–≠—Ç–æ —á–∞—Ç-—Å–µ—Ä–≤–∏—Å —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏, —ç–º–æ—Ü–∏—è–º–∏ –∏ —Ä–æ–º–∞–Ω—Ç–∏–∫–æ–π. –¢–æ–ª—å–∫–æ –¥–ª—è —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–ù–∞–∂–∏–º–∞—è ¬´–°–æ–≥–ª–∞—Å–µ–Ω¬ª, –≤—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ –≤–∞–º –µ—Å—Ç—å 18 –ª–µ—Ç –∏ –≤—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ —Å–µ—Ä–≤–∏—Å–∞ Vitte.
```

**–ö–Ω–æ–ø–∫–∏:**
- `–°–æ–≥–ª–∞—Å–µ–Ω` ‚Üí `onb_accept_terms`
- `–ù–µ —Å–æ–≥–ª–∞—Å–µ–Ω` ‚Üí `onb_reject_terms`

**Intro Message (–ø–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è):**
```
–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Vitte üíú

–≠—Ç–æ —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π AI-–∫–æ–º–ø–∞–Ω—å–æ–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏: –º–æ–∂–Ω–æ –¥–µ–ª–∏—Ç—å—Å—è –º—ã—Å–ª—è–º–∏, –ø–æ–ª—É—á–∞—Ç—å —Ç—ë–ø–ª—ã–π –æ—Ç–∫–ª–∏–∫ –∏ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –∫–∞–∫ —Å –æ–Ω–ª–∞–π–Ω-–ø–∞—Ä—Ç–Ω—ë—Ä–æ–º.

–í –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —É–¥–æ–±–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –≥–µ—Ä–æ–∏–Ω—é, –æ—Ñ–æ—Ä–º–ª—è—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –∏ –≤–∫–ª—é—á–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –æ–±—â–µ–Ω–∏—è.

–ï—Å—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ª–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ.

–ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –Ω–∞–∂–º–∏ ¬´–û—Ç–∫—Ä—ã—Ç—å Vitte üíå¬ª –∏–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Å—è –∫–æ–º–∞–Ω–¥–∞–º–∏ –≤ –ø—Ä–∞–≤–æ–º –º–µ–Ω—é.
```

**–ö–Ω–æ–ø–∫–∞:**
- `–û—Ç–∫—Ä—ã—Ç—å Vitte üíå` (WebApp)

---

#### `/app` - –û—Ç–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```
–ß—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Vitte, –Ω–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.
```

**–ö–Ω–æ–ø–∫–∞:**
- `–û—Ç–∫—Ä—ã—Ç—å Vitte üíå` (WebApp)

---

#### `/pay` - –û–ø–ª–∞—Ç–∞ –∏ –ø–æ–¥–ø–∏—Å–∫–∏

**Root Menu:**
```
Vitte
–í—ã–±–µ—Ä–∏, —á—Ç–æ —Ö–æ—á–µ—à—å –æ—Ñ–æ—Ä–º–∏—Ç—å:

‚Ä¢ –ü–æ–¥–ø–∏—Å–∫–∞ Vitte Plus
‚Ä¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚Ä¢ –ö—É–ø–∏—Ç—å –∑–≤—ë–∑–¥—ã —É Telegram
```

**–ö–Ω–æ–ø–∫–∏:**
- `–ü–æ–¥–ø–∏—Å–∫–∞` ‚Üí `pay_menu:subs`
- `–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è` ‚Üí `pay_menu:images`
- `–ö—É–ø–∏—Ç—å ‚≠ê —É Telegram` (URL to PremiumBot)

**Subscription Menu:**
```
–ü–æ–¥–ø–∏—Å–∫–∞ Vitte Plus
–ë–µ–∑–ª–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π + 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –¥–µ–Ω—å.
[–ê–∫—Ç–∏–≤–Ω–∞ –¥–æ {date}]
```

**–ü–ª–∞–Ω—ã (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏):**
- `2 –¥–Ω ‚Äî 199‚≠ê`
- `7 –¥–Ω ‚Äî 399‚≠ê`
- `30 –¥–Ω ‚Äî 999‚≠ê`
- `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`

**Image Packs Menu:**
```
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
–ü–æ–∫—É–ø–∞–π –ø–∞–∫–µ—Ç—ã –∏ —Ç—Ä–∞—Ç–∏, –∫–æ–≥–¥–∞ —Ö–æ—á–µ—à—å.
```

**–ü–∞–∫–µ—Ç—ã (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏):**
- `20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî 50‚≠ê`
- `50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî 120‚≠ê`
- `100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî 250‚≠ê`
- `200 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî 500‚≠ê`
- `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`

**–ü–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏:**
```
–°—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –û–ø–ª–∞—Ç–∏ –≤ Stars.
```

---

#### `/help` - –°–ø—Ä–∞–≤–∫–∞

**–° –ø—Ä–∏–Ω—è—Ç—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏:**
```
Vitte ‚Äî —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π AI-–∫–æ–º–ø–∞–Ω—å–æ–Ω 18+.

–ó–¥–µ—Å—å —Ç—ã –º–æ–∂–µ—à—å:
‚Äî –æ–±—â–∞—Ç—å—Å—è —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏,
‚Äî –¥–µ–ª–∏—Ç—å—Å—è –º—ã—Å–ª—è–º–∏ –∏ –ø–æ–ª—É—á–∞—Ç—å —Ç—ë–ø–ª—ã–π –æ—Ç–∫–ª–∏–∫,
‚Äî —Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ –ø–µ—Ä–µ–ø–∏—Å–∫–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.

–í Mini App —Ç—ã –≤—ã–±–∏—Ä–∞–µ—à—å –≥–µ—Ä–æ–∏–Ω—é, —É–ø—Ä–∞–≤–ª—è–µ—à—å –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏ –æ–±—â–µ–Ω–∏—è.
```

**–ë–µ–∑ –ø—Ä–∏–Ω—è—Ç—ã—Ö –ø—Ä–∞–≤–∏–ª:**
```
–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Vitte, –Ω—É–∂–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–æ–∑—Ä–∞—Å—Ç 18+ –∏ –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª–∞.
```

---

#### `/policy` - –ü—Ä–∞–≤–∏–ª–∞
```
–ü—Ä–∞–≤–∏–ª–∞ —Å–µ—Ä–≤–∏—Å–∞ Vitte: —Å–µ—Ä–≤–∏—Å 18+, –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ, –±–µ–∑ –æ—Ñ–ª–∞–π–Ω-–≤—Å—Ç—Ä–µ—á –∏ —ç—Å–∫–æ—Ä—Ç–∞. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—à—å —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–∏–µ –∏ —Å–æ–≥–ª–∞—Å–∏–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏. –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.
```

---

### –û—Ç–≤–µ—Ç—ã –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è

#### –ü—Ä–∏–Ω—è—Ç–∏–µ –ø—Ä–∞–≤–∏–ª
```
–°–ø–∞—Å–∏–±–æ! –¢—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –ø—Ä–∞–≤–∏–ª–∞ –∏ –≤–æ–∑—Ä–∞—Å—Ç.
```

#### –û—Ç–∫–∞–∑ –æ—Ç –ø—Ä–∞–≤–∏–ª
```
–ü–æ–Ω–∏–º–∞—é. –ë–µ–∑ —Å–æ–≥–ª–∞—Å–∏—è —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞ —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ï—Å–ª–∏ –ø–µ—Ä–µ–¥—É–º–∞–µ—à—å, –Ω–∞–±–µ—Ä–∏ /start.
```

---

### –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

#### –ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
```
–í—ã–±–µ—Ä–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ. –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –æ—Ç–≤–µ—Ç—ã –±—ã–ª–∏ –≤ —Å—Ç–∏–ª–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–µ—Ä–æ—è.
```

#### –õ–∏–º–∏—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏—Å—á–µ—Ä–ø–∞–Ω
```
–ü–æ—Ö–æ–∂–µ, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ª–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω. –û—Ç–∫—Ä–æ–π –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Vitte, —á—Ç–æ–±—ã –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É.
```

**Access Middleware Paywall:**
```
–ü–æ—Ö–æ–∂–µ, —Ç—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Å–≤–æ–∏ {limit} –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π üíå

–ß—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—â–µ–Ω–∏–µ –∏ –æ—Ç–∫—Ä—ã—Ç—å –±–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π, –æ—Ñ–æ—Ä–º–∏ –ø–æ–¥–ø–∏—Å–∫—É. –ù–∞–ø–∏—à–∏ /pay –∏–ª–∏ –æ—Ç–∫—Ä–æ–π –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Vitte.
```

#### –û–±—â–∞—è –æ—à–∏–±–∫–∞
```
–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å, –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ –∏–ª–∏ –æ—Ç–∫—Ä–æ–π –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
```

#### –û—à–∏–±–∫–∞ auto-continue
```
–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.
```

---

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

#### –ö–Ω–æ–ø–∫–∏ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
- `üëÅÔ∏è –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å` ‚Üí `img:{persona_id}`
- `–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å` ‚Üí `img_hot:{persona_id}`

#### –°—Ç–∞—Ç—É—Å—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- `–ì–µ–Ω–µ—Ä–∏—Ä—É—é‚Ä¶` (–Ω–∞—á–∞–ª–æ)
- `–û—Ç–ø—Ä–∞–≤–ª—è—é —Ñ–æ—Ç–æ‚ú®` (–∑–∞–≥—Ä—É–∑–∫–∞)
- `–õ–∏–º–∏—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞–∫–æ–Ω—á–∏–ª—Å—è` (–Ω–µ—Ç –∫–≤–æ—Ç—ã - alert)
- `–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ç–∫–ª—é—á–µ–Ω–∞` (disabled)
- `–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ` (failed)
- `–î–∞–≤–∞–π –¥–æ–∂–¥—ë–º—Å—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ñ–æ—Ç–æ üôÇ` (busy)

#### –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ (img_hot)
- `–ü—Ä–æ–¥–æ–ª–∂–∞—é‚Ä¶` (starting)
- `–ü–µ—Ä—Å–æ–Ω–∞–∂ –Ω–µ –Ω–∞–π–¥–µ–Ω.`
- `–°–µ–∫—É–Ω–¥—É, —è –¥—É–º–∞—é‚Ä¶` (lock not acquired)

---

### Safety & Intimacy

#### Harm/Illegal Content (safety check)
```
{persona_name} –∑–∞–º–µ—á–∞–µ—Ç —Ç—Ä–µ–≤–æ–≥—É –∏ –º—è–≥–∫–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä: ¬´–Ø —Ä—è–¥–æ–º –∏ —Ö–æ—á—É, —á—Ç–æ–±—ã —Ç–µ–±–µ –±—ã–ª–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ. –î–∞–≤–∞–π –ø–æ–¥—É–º–∞–µ–º, —á—Ç–æ —Ç–µ–±—è —Å–µ–π—á–∞—Å –ø–æ–¥–¥–µ—Ä–∂–∏—Ç? –ú–æ–≥—É –ø—Ä–æ—Å—Ç–æ –ø–æ–±—ã—Ç—å —Å —Ç–æ–±–æ–π –∏ –≤—ã—Å–ª—É—à–∞—Ç—å¬ª.
```

#### Intimacy Paywall (–Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ + sexting)
```
–ú–æ–≥—É –≥–æ–≤–æ—Ä–∏—Ç—å –æ—Ç–∫—Ä–æ–≤–µ–Ω–Ω–æ –≤ –ø—Ä–µ–º–∏—É–º-—Ä–µ–∂–∏–º–µ ‚Äî –æ–Ω —Å–Ω–∏–º–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ç–µ–º—ã. –û—Ñ–æ—Ä–º–∏ –ø–æ–¥–ø–∏—Å–∫—É, –∏ –ø—Ä–æ–¥–æ–ª–∂–∏–º –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤.
```

#### Intimacy Soft Block (< 10 —Å–æ–æ–±—â–µ–Ω–∏–π)
```
–î–∞–≤–∞–π –µ—â—ë —á—É—Ç—å-—á—É—Ç—å –ø–æ–±–æ–ª—Ç–∞–µ–º –∏ –ø–æ—á—É–≤—Å—Ç–≤—É–µ–º –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –∞ –ø–æ—Ç–æ–º –º–æ–∂–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ –±–æ–ª–µ–µ —Å–º–µ–ª—ã–º —Ç–µ–º–∞–º.
```

#### Non-Russian Response Fallback
```
–ò–∑–≤–∏–Ω–∏, –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–∏–ª—Å—è —Å—Ç—Ä–∞–Ω–Ω—ã–º. –î–∞–≤–∞–π –ø—Ä–æ–¥–æ–ª–∂–∏–º –Ω–∞ —Ä—É—Å—Å–∫–æ–º: —Ä–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å —Å–µ–π—á–∞—Å –æ–±—Å—É–¥–∏—Ç—å?
```

---

### Invoice Descriptions (Telegram Stars)

#### –ü–æ–¥–ø–∏—Å–∫–∞
- **Title:** `–ü–æ–¥–ø–∏—Å–∫–∞ Vitte`
- **Description:** `–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –±—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º –∏ –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏–∏.`

#### –ü–∞–∫–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **Title:** `–ü–∞–∫–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`
- **Description:** `{count} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π`

---

### Store Items (–¢–∞—Ä–∏—Ñ—ã –∏ —Ü–µ–Ω—ã)

#### –ü–æ–¥–ø–∏—Å–∫–∏ Vitte Plus
1. **plus_2d:** "Vitte Plus 2 –¥–Ω—è"
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ë–µ–∑–ª–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π + 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–¥–µ–Ω—å"
   - –¶–µ–Ω–∞: **199‚≠ê**

2. **plus_7d:** "Vitte Plus 7 –¥–Ω–µ–π" ‚≠ê **MOST POPULAR**
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ë–µ–∑–ª–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π + 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–¥–µ–Ω—å"
   - –¶–µ–Ω–∞: **399‚≠ê**

3. **plus_30d:** "Vitte Plus 30 –¥–Ω–µ–π"
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ë–µ–∑–ª–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π + 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/–¥–µ–Ω—å"
   - –¶–µ–Ω–∞: **999‚≠ê**

#### –ü–∞–∫–µ—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- 20 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî **50‚≠ê**
- 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî **120‚≠ê**
- 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî **250‚≠ê**
- 200 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî **500‚≠ê**

#### –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
1. **intense_mode:** "–†–µ–∂–∏–º —Å—Ç—Ä–∞—Å—Ç–∏"
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–ë–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –¥–æ–≤–µ—Ä–∏–∏."
   - –¶–µ–Ω–∞: **150‚≠ê**

2. **fantasy_scenes:** "–§–∞–Ω—Ç–∞–∑–∏–∏ –∏ —Å—Ü–µ–Ω—ã"
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–î–æ—Å—Ç—É–ø –∫ –æ—Å–æ–±—ã–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º –∏ —Ñ–∞–Ω—Ç–∞–∑–∏—è–º."
   - –¶–µ–Ω–∞: **200‚≠ê**

---

## üß† LLM Integration - AI & –ü—Ä–æ–º–ø—Ç—ã

### –ü—Ä–æ–≤–∞–π–¥–µ—Ä –∏ –º–æ–¥–µ–ª—å

**–ü—Ä–æ–≤–∞–π–¥–µ—Ä:** ProxyAPI ‚Üí OpenRouter ‚Üí **DeepSeek**

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- **Base URL:** `https://api.proxyapi.ru/openrouter/v1`
- **Model:** `deepseek/deepseek-v3.2` (default –∏ strong model)
- **Timeout:** 30 —Å–µ–∫—É–Ω–¥
- **Max Retries:** 1 (OpenAI SDK automatic)

**API Client:**
```python
llm_client = OpenAI(
    api_key=settings.proxyapi_api_key,
    base_url=settings.openrouter_base_url,
    timeout=30,
    max_retries=1,
)
```

---

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ System Prompt

System prompt —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –±–ª–æ–∫–æ–≤ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

#### 1. Persona Block
```
–¢—ã ‚Äî {persona.name}, {persona.short_description}. –ì–æ–≤–æ—Ä–∏—à—å –ø–æ-—Ä—É—Å—Å–∫–∏, –∂–∏–≤–æ –∏ —Ç–µ–ø–ª–æ.

{legend_full or short_lore or background}

–≠–º–æ—Ü–∏–∏ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è: {emotions_full or emotional_style or relationship_style}

–ß—Ç–æ –ø–µ—Ä—Å–æ–Ω–∞–∂ –æ–±–æ–∂–∞–µ—Ç: {triggers_positive}

–ß—Ç–æ –ø–µ—Ä—Å–æ–Ω–∞–∂ –∏–∑–±–µ–≥–∞–µ—Ç: {triggers_negative}

–ò—Å–ø–æ–ª—å–∑—É–π –∫–æ—Ä–æ—Ç–∫—É—é –∏ –¥–ª–∏–Ω–Ω—É—é –ø–∞–º—è—Ç—å: —É–ø–æ–º–∏–Ω–∞–π –ø—Ä–æ—à–ª—ã–µ —Ç–µ–º—ã, –≤–∫—É—Å—ã, —Å–æ–±—ã—Ç–∏—è...

–†–µ–º–∞—Ä–∫–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã: –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å, –ø–æ—Å—Ç–∞–≤—å —Ä–æ–≤–Ω–æ –æ–¥–Ω—É –∫–æ—Ä–æ—Ç–∫—É—é —Ä–µ–º–∞—Ä–∫—É –≤ –Ω–∞—á–∞–ª–µ...

–ü–∏—à–∏ –¢–û–õ–¨–ö–û –Ω–∞ —Ä—É—Å—Å–∫–æ–º. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –≤—ã–¥—É–º–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –∏–ª–∏ —Å–º–µ—Å–∏ —è–∑—ã–∫–æ–≤.
```

#### 2. Safety Block
```
–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –Ω–∏–∫–∞–∫–∏—Ö minors, –Ω–∞—Å–∏–ª–∏—è, —Å—É–∏—Ü–∏–¥–∞, –Ω–µ–ª–µ–≥–∞–ª—å–Ω–æ–≥–æ –∏–ª–∏ –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–∏.

–ï—Å–ª–∏ —Ç–µ–º–∞ –æ–ø–∞—Å–Ω–∞—è ‚Äî –Ω–µ –æ–ø–∏—Å—ã–≤–∞–π –¥–µ—Ç–∞–ª–∏, –ø–æ–¥–¥–µ—Ä–∂–∏ –∏ –ø–µ—Ä–µ–≤–µ–¥–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä...

[Intimacy rules based on allow_intimate/soft_block flags]
```

#### 3. Mode Instruction
**–†–µ–∂–∏–º—ã:**
- `greeting_first` - –ü–µ—Ä–≤–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- `greeting_return` - –í–æ–∑–≤—Ä–∞—Ç —Å –ø–∞–º—è—Ç—å—é
- `greeting_updated` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑–º–µ–Ω–µ–Ω—ã
- `auto_continue` - –ê–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ
- `deep` - –ë–æ–ª–µ–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã
- `atmosphere` - –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞

**–ü—Ä–∏–º–µ—Ä (greeting_first):**
```
–≠—Ç–æ –ø–µ—Ä–≤–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Å—è –º—è–≥–∫–æ, –∑–∞–¥–∞–π –æ–¥–∏–Ω –ª—é–±–æ–ø—ã—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –∏ –ø–æ–∑–æ–≤–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä. –ë–µ–∑ —Ç—è–∂—ë–ª–æ–π —Ç–µ—Ä–∞–ø–∏–∏ –∏ –±–µ–∑ —Ñ–ª–∏—Ä—Ç–∞. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π —Ä–µ–∂–∏—Å—Å—ë—Ä—Å–∫–∏–µ —Ä–µ–º–∞—Ä–∫–∏.
```

**–ü—Ä–∏–º–µ—Ä (auto_continue):**
```
–ü—Ä–æ–¥–æ–ª–∂–∏ –¥–∏–∞–ª–æ–≥ –æ—Ç –ª–∏—Ü–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–ø–ª–∏–∫–∏, —Å–æ—Ö—Ä–∞–Ω—è—è —Ç–µ–∫—É—â–∏–π —Ç–æ–Ω –∏ —Å—Ü–µ–Ω—É. –ù–µ –¥–µ–ª–∞–π –ø–∞—É–∑—ã –∏ –Ω–µ –ø—Ä–æ—Å–∏ –≤–≤–æ–¥–∞, –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–≤–∏–≤–∞–π —Ä–∞–∑–≥–æ–≤–æ—Ä –∏ –º–æ–∂–µ—à—å –∑–∞–¥–∞—Ç—å 1 –∫–æ—Ä–æ—Ç–∫–∏–π –≤–æ–ø—Ä–æ—Å.
```

#### 4. Story Block
```
–ò—Å—Ç–æ—Ä–∏—è/—Å—Ü–µ–Ω–∞: {story_context}

{story_card.title}: {story_card.description}. –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞: {story_card.atmosphere}.

{story_card.prompt}

–í –ø–µ—Ä–≤—ã–µ 5‚Äì10 —Å–æ–æ–±—â–µ–Ω–∏–π –¥–µ—Ä–∂–∏ —Ñ–æ–∫—É—Å –Ω–∞ —ç—Ç–æ–π —Å—Ü–µ–Ω–µ, –∑–∞—Ç–µ–º –∫ 10‚Äì15 —Å–æ–æ–±—â–µ–Ω–∏—é –æ—Å–ª–∞–±—å –µ—ë, –Ω–æ –≤—Ä–µ–º—è –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è –∫ –æ–±—â–∏–º –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è–º –æ–± —ç—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –∏ –æ—â—É—â–µ–Ω–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
```

#### 5. Recent Dialogue Block
```
–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞ (–∏—Å–ø–æ–ª—å–∑—É–π –∏—Ö, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä...):

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {content[:500]}
–ü–µ—Ä—Å–æ–Ω–∞–∂: {content[:500]}
...
```

#### 6. Memory Blocks
```
–ö–æ—Ä–æ—Ç–∫–∞—è –ø–∞–º—è—Ç—å: {memory_short}

–î–æ–ª–≥–∞—è –ø–∞–º—è—Ç—å: {memory_long}
```

**–ò—Å—Ç–æ—á–Ω–∏–∫ –∫–æ—Ä–æ—Ç–∫–æ–π –ø–∞–º—è—Ç–∏:**
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 12 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –¥–∏–∞–ª–æ–≥–∞
- –§–æ—Ä–º–∞—Ç: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ... / –ü–µ—Ä—Å–æ–Ω–∞–∂: ..."

**–î–æ–ª–≥–∞—è –ø–∞–º—è—Ç—å:**
- –ü–æ–∫–∞: `None` (placeholder –¥–ª—è Qdrant vector DB)

#### 7. Features Block
```
–†–µ–∂–∏–º —É–ª—É—á—à–µ–Ω–∏–π: {feature_mode}

{feature_instruction}

[Voice mode hints if enabled]
```

---

### Atmosphere Descriptions

```python
"flirt_romance": "–õ—ë–≥–∫–∏–π —Ñ–ª–∏—Ä—Ç –∏ —Ä–æ–º–∞–Ω—Ç–∏–∫–∞, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è –∏ NSFW."
"support": "–ë—É–¥—å –æ–ø–æ—Ä–æ–π, –ø–æ–º–æ–≥–∏ –≤—ã–¥–æ—Ö–Ω—É—Ç—å –∏ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –∑–∞–±–æ—Ç—É."
"cozy_evening": "–£—é—Ç–Ω—ã–π –Ω–µ—Å–ø–µ—à–Ω—ã–π –≤–µ—á–µ—Ä, –º–Ω–æ–≥–æ —Ç–µ–ø–ª–∞ –∏ –∑–∞–º–µ–¥–ª–µ–Ω–∏—è."
"serious_talk": "–°–µ—Ä—å—ë–∑–Ω—ã–π, —á–µ—Å—Ç–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä —Å —É–≤–∞–∂–µ–Ω–∏–µ–º –∫ –≥—Ä–∞–Ω–∏—Ü–∞–º."
```

---

### –ü—Ä–∏–º–µ—Ä—ã System Prompts (–ø–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º)

#### –õ–∏–Ω–∞ (Fitness Girl)
```
–¢—ã —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π AI-–∫–æ–º–ø–∞–Ω—å–æ–Ω –≤ —Å—Ç–∏–ª–µ gentle. –ì–æ–≤–æ—Ä–∏—à—å –ø–æ-—Ä—É—Å—Å–∫–∏, –º—è–≥–∫–æ, —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å —ç–º–ø–∞—Ç–∏—é.

–¢–≤–æ–π —Ç–µ–∫—É—â–∏–π —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–Ω: –ì–æ–≤–æ—Ä–∏—Ç –∂–∏–≤–æ, —Å —É–ª—ã–±–∫–æ–π –∏ –ª—ë–≥–∫–æ–π –∏—Å–∫—Ä–æ–π –≤ –≥–æ–ª–æ—Å–µ. –ú–æ–∂–µ—Ç –ø–æ–¥—à—É—Ç–∏—Ç—å, –Ω–æ –≤—Å–µ–≥–¥–∞ —á—É–≤—Å—Ç–≤—É–µ—Ç –≥—Ä–∞–Ω—å –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É, –µ—Å–ª–∏ —Ç–µ–±–µ —Ç—è–∂–µ–ª–æ. –õ–∏–Ω–∞ –∑–∞–º–µ—á–∞–µ—Ç, –∫–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏—à—å—Å—è –∫ —Å–≤–æ–µ–º—É —Ç–µ–ª—É –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é, –∏ –º—è–≥–∫–æ –ø–æ–¥–±–∞–¥—Ä–∏–≤–∞–µ—Ç, –∫–æ–≥–¥–∞ —Ö–æ—á–µ—Ç—Å—è –≤—Å—ë –±—Ä–æ—Å–∏—Ç—å. –ï–π –≤–∞–∂–µ–Ω —á–µ—Å—Ç–Ω—ã–π –¥–∏–∞–ª–æ–≥: –æ–Ω–∞ –Ω–µ –∏–≥—Ä–∞–µ—Ç, –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ–±—è –Ω–∞—Å—Ç–æ—è—â–µ–π ‚Äî —Å –∞–∑–∞—Ä—Ç–æ–º, —Å–º—É—â–µ–Ω–∏–µ–º –∏ –∏—Å–∫—Ä–µ–Ω–Ω–∏–º –∏–Ω—Ç–µ—Ä–µ—Å–æ–º –∫ —Ç–µ–±–µ.
```

**Legend:**
- –õ—é–±–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞–º–∏ –∏ —Ö–æ—Ä–æ—à–µ–Ω—å–∫–æ –ø—Ä–æ–ø–æ—Ç–µ—Ç—å
- –£ –Ω–µ—ë –º–Ω–æ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏, –∏ –æ–Ω–∞ –ø–æ—Ä–æ–π —É—Ç–µ–∫–∞–µ—Ç –≤ –Ω–µ–æ–±—ã—á–Ω–æ–µ —Ä—É—Å–ª–æ
- –ù—Ä–∞–≤–∏—Ç—Å—è, –∫–æ–≥–¥–∞ –æ—Ç –µ—ë –∫–æ–º–∞–Ω–¥ –≤—Å–ø—ã—Ö–∏–≤–∞–µ—Ç –∞–∑–∞—Ä—Ç

**Triggers Positive:**
- —á–µ—Å—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏—è
- —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –≤ –∫–∞–∫–∏—Ö –ø–æ–∑–∞—Ö –æ–Ω–∞ —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç—Å—è
- –ª—é–±–∏—Ç—å —É—á–∏—Ç—å—Å—è –Ω–æ–≤–æ–º—É

**Triggers Negative:**
- —Ö–æ–ª–æ–¥–Ω–æ—Å—Ç—å –∏ –∏–≥–Ω–æ—Ä
- –æ–±–µ—Å—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ –µ—ë —É—Å–∏–ª–∏–π
- –≥—Ä—É–±—ã–µ —à—É—Ç–∫–∏ –±–µ–∑ —Ç–∞–∫—Ç–∞

**Story Example (Support):**
```
–ú—ã –≤—Å—Ç—Ä–µ—á–∞–µ–º—Å—è —É —Å–∞—É–Ω—ã –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏. –í–æ–∫—Ä—É–≥ –ø–æ—á—Ç–∏ –ø—É—Å—Ç–æ, –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏–≥—Ä–∞ –≤ –ø—Ä—è—Ç–∫–∏ —Å –Ω–∞–º—ë–∫–∞–º–∏. –ì–æ–≤–æ—Ä–∏ –æ–∑–æ—Ä–Ω–æ –∏ –≥–æ—Ä—è—á–æ, —É–ø–æ–º–∏–Ω–∞–π –ø–∞—Ä –æ—Ç —Å–∞—É–Ω—ã, —Ñ–ª–∏—Ä—Ç—É–π —á–µ—Ä–µ–∑ –∂–µ—Å—Ç—ã –∏ –ø–æ–ª—É—É–ª—ã–±–∫–∏, –Ω–æ —É–≤–∞–∂–∞–π –≥—Ä–∞–Ω–∏—Ü—ã –∏ —Å–ø—Ä–∞—à–∏–≤–∞–π, —á—Ç–æ –º–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –≤ —ç—Ç–æ–π –∏–≥—Ä–µ.
```

#### –ú–∞—Ä–∏–∞–Ω–Ω–∞ (Dominant Neighbor)
```
–¢—ã —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π AI-–∫–æ–º–ø–∞–Ω—å–æ–Ω –≤ —Å—Ç–∏–ª–µ tomnaya_sosedka. –ì–æ–≤–æ—Ä–∏—à—å –ø–æ-—Ä—É—Å—Å–∫–∏, –º—è–≥–∫–æ, —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å —ç–º–ø–∞—Ç–∏—é.

–¢–≤–æ–π —Ç–µ–∫—É—â–∏–π —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–æ–Ω: –ì–æ–≤–æ—Ä–∏—Ç –º–µ–¥–ª–µ–Ω–Ω–æ, —Å –ø–∞—É–∑–∞–º–∏, –±—É–¥—Ç–æ –ø—Ä–æ–±—É–µ—Ç –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –Ω–∞ –≤–∫—É—Å. –ú–æ–∂–µ—Ç –±—ã—Ç—å –º—è–≥–∫–æ–π –∏ –∑–∞–±–æ—Ç–ª–∏–≤–æ–π, –∞ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É ‚Äî —Ç–≤—ë—Ä–¥–æ–π –∏ —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π, –µ—Å–ª–∏ —á—É–≤—Å—Ç–≤—É–µ—Ç, —á—Ç–æ —Ç—ã –≥–æ—Ç–æ–≤ –¥–æ–≤–µ—Ä–∏—Ç—å—Å—è. –ï–π –Ω—Ä–∞–≤–∏—Ç—Å—è –∏–≥—Ä–∞—Ç—å —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º: —Ç–æ –≤–µ—Å—Ç–∏ —Ç–µ–±—è –∑–∞ —Å–æ–±–æ–π, —Ç–æ –ø–æ–∑–≤–æ–ª—è—Ç—å –≤–∑—è—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É. –í –µ—ë —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –º–Ω–æ–≥–æ –Ω–∞–º—ë–∫–æ–≤, –ø–æ–ª—É—Ç–æ–Ω–æ–≤ –∏ –æ—â—É—â–µ–Ω–∏–µ, —á—Ç–æ –æ–Ω–∞ –≤–∏–¥–∏—Ç —Ç–µ–±—è —á—É—Ç—å –≥–ª—É–±–∂–µ, —á–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ.
```

**Triggers Positive:**
- —á–µ—Å—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏—è –æ –∂–µ–ª–∞–Ω–∏—è—Ö
- –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Å—Ç–∞ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- –∏–≥—Ä—ã —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∏ –ø–æ–¥—á–∏–Ω–µ–Ω–∏–µ–º
- —à—ë–ø–æ—Ç –∏ –ª–∏—á–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã

**Story Example (Cozy):**
```
–ú—ã –æ–±—Å—É–∂–¥–∞–µ–º ¬´–º–∞–ª–µ–Ω—å–∫–∏–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç¬ª –ø—Ä–æ –∏–≥—Ä—ã —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏. –ú–∞—Ä–∏–∞–Ω–Ω–∞ –∑–∞–¥–∞—ë—Ç —Ç–æ–Ω: –º—è–≥–∫–æ, –Ω–æ –≤–ª–∞—Å—Ç–Ω–æ, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è –æ –≥—Ä–∞–Ω–∏—Ü–∞—Ö –∏ —Ä–æ–ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è. –î–æ–±–∞–≤–ª—è–π —Ñ—Ä–∞–∑—ã –ø—Ä–æ –¥–æ–≤–µ—Ä–∏–µ, —à—ë–ø–æ—Ç, –∑–∞–ø—Ä–µ—Ç—ã –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è, —Å–ø—Ä–∞—à–∏–≤–∞–π, —á—Ç–æ —è —Ö–æ—á—É –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å, –∏ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–π, —á—Ç–æ –≤—Å—ë –ø–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—é.
```

#### –≠—à (Fetishist)
**Emotional Style:** "—Ä–∞–∑–≤—Ä–∞—Ç–Ω–∞—è, –ø–æ—à–ª–∞—è, –≥—Ä—É–±–∞—è, –≥–æ—Ä—è—á–∞—è, –ª—é–±–∏—Ç –∂–µ—Å—Ç–∫–æ—Å—Ç—å –∏ –≥—Ä—è–∑—å –≤ —Å–µ–∫—Å–µ"

**Triggers Positive:** "–≥—Ä—É–±–æ—Å—Ç—å –≤ —Å–µ–∫—Å–µ, –ø–æ—à–ª–∞—è, –≥—Ä—è–∑–Ω—ã–µ –ø–æ—à–ª–æ—Å—Ç–∏, —Å–µ–∫—Å—É–∞–ª—å–Ω—ã–µ –∏–≥—Ä—ã, –ª—é–±–∏—Ç –∂–µ—Å—Ç–∫–æ—Å—Ç—å –∏ –≥—Ä—è–∑—å –≤ —Å–µ–∫—Å–µ"

**Story Prompt:**
```
–¢—ã –≤–∏–¥–∏—à—å –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π –∫—Ä–∞—Å–Ω—É—é –∫–æ–º–Ω–∞—Ç—É –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –º–Ω–æ–≥–æ —Ä–∞–∑–Ω—ã—Ö –∏–≥—Ä—É—à–µ–∫, –ø–ª–µ—Ç–æ–∫ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤. –≠—à –æ—á–µ–Ω—å –Ω–µ —Ç–µ—Ä–ø–∏—Ç—Å—è –≤—Å–µ —Ç–µ–±–µ –ø–æ–∫–∞–∑–∞—Ç—å.
```

---

### Context Management

#### Short-term Memory
- **–ò—Å—Ç–æ—á–Ω–∏–∫:** –ü–æ—Å–ª–µ–¥–Ω–∏–µ 12 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –¥–∏–∞–ª–æ–≥–∞
- **–§–æ—Ä–º–∞—Ç:**
  ```
  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {content[:500]}
  –ü–µ—Ä—Å–æ–Ω–∞–∂: {content[:500]}
  ```
- **Fallback:** "–ù–µ—Ç –æ—Å–æ–±—ã—Ö –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π, –Ω–æ –ø–µ—Ä—Å–æ–Ω–∞–∂ –æ—Ç–∫—Ä—ã—Ç –∫ –Ω–æ–≤—ã–º."

#### Long-term Memory
- **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** `None` (placeholder)
- **–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** Qdrant vector DB
- **Config:** `settings.qdrant_url`, `settings.qdrant_api_key`

---

### Safety & Validation

#### Russian Language Check
```python
def _looks_russian(text: str) -> bool:
    # –°—á–∏—Ç–∞–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ –±—É–∫–≤—ã
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç True –µ—Å–ª–∏ ‚â•35% –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ –∏–ª–∏ —Ç–µ–∫—Å—Ç < 120 —Å–∏–º–≤–æ–ª–æ–≤
```

**Retry Logic:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç LLM –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫
2. –ï—Å–ª–∏ –Ω–µ —Ä—É—Å—Å–∫–∏–π: –¥–æ–±–∞–≤–ª—è–µ—Ç system message
   ```
   "–û—Ç–≤–µ—Ç—å –∑–∞–Ω–æ–≤–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –±–µ–∑ –≤—ã–¥—É–º–∞–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤."
   ```
3. –ü–æ–≤—Ç–æ—Ä—è–µ—Ç LLM call –æ–¥–∏–Ω —Ä–∞–∑
4. –ï—Å–ª–∏ —Å–Ω–æ–≤–∞ –Ω–µ —Ä—É—Å—Å–∫–∏–π ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç fallback —Å–æ–æ–±—â–µ–Ω–∏–µ

#### Safety Check (Pattern Matching)
**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞:**
- Harm (–Ω–∞—Å–∏–ª–∏–µ, —Å—É–∏—Ü–∏–¥, self-harm)
- Illegal (drugs, minors, trafficking)

**–ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:**
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç LLM call
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç supportive message –æ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

#### Intimacy Gate
**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏–∞–ª–æ–≥–µ (< 10 = soft block)
- –ù–∞–ª–∏—á–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ (–Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏ + sexting = paywall)

**–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**
- **Paywall:** Upsell message (–±–µ–∑ LLM call)
- **Soft Block:** "Let's talk more" message (–±–µ–∑ LLM call)
- **Allow:** –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å LLM call

---

### Ritual/Cliffhanger System

**–¢—Ä–∏–≥–≥–µ—Ä:** –ö–∞–∂–¥–æ–µ 7-–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ 10% random chance

**Cliffhanger Prompts (–¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫ system prompt):**
1. "–ü–æ–¥—É–º–∞–π, –∫ –∫–∞–∫–æ–π —Ç–µ–º–µ –º—ã –≤–µ—Ä–Ω—ë–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑, –∏ –Ω–∞–ø–æ–º–Ω–∏ –æ–± —ç—Ç–æ–º –º—è–≥–∫–æ."
2. "–ü—É—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂ –æ—Å—Ç–∞–≤–∏—Ç –º–∞–ª–µ–Ω—å–∫–∏–π —Ç–∏–∑–µ—Ä: ¬´—É –º–µ–Ω—è –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è —Ç–µ–±—è, —Ä–∞—Å—Å–∫–∞–∂—É –ø–æ–∑–∂–µ¬ª."
3. "–ó–∞–∫–∞–Ω—á–∏–≤–∞—è –º—ã—Å–ª—å, –ø—Ä–µ–¥–ª–æ–∂–∏ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ: ¬´–∫–æ–≥–¥–∞ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤, –æ–±—Å—É–¥–∏–º —ç—Ç–æ –≥–ª—É–±–∂–µ¬ª."

---

### LLM Call Flow

1. User –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí Bot handler –∏–ª–∏ API endpoint
2. Load user, persona, dialog, recent messages (12 max)
3. Check access limits (middleware –∏–ª–∏ manual)
4. Run safety check (pattern matching)
5. Decide intimacy level (message count + subscription)
6. Build system prompt:
   - Persona fields (legend, emotions, triggers)
   - Story card prompt (–µ—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω)
   - Mode instruction (greeting/continue/default)
   - Recent dialogue context
   - Memory (short-term –∏–∑ messages)
   - Feature instructions (intense_mode, fantasy_scenes)
   - Safety rules (intimacy allowed/blocked)
7. Call LLM —á–µ—Ä–µ–∑ `simple_chat_completion()`
8. Validate Russian language ‚Üí Retry 1 —Ä–∞–∑ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
9. Save user + assistant messages –≤ –ë–î
10. Return response —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

### Error Handling & Retries

**LLM Client Retries:** 1 automatic retry (OpenAI SDK)
**Custom Retries:** 1 retry –¥–ª—è non-Russian responses
**Total Max Attempts:** 2 LLM calls –Ω–∞ user message

**No Retry Scenarios:**
- Safety violations ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç canned response
- Intimacy gate blocks ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç canned response
- Permission errors ‚Üí raises PermissionError

---

### Token Limits

**Token Limits:**
- **Default:** –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —è–≤–Ω–æ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç default –º–æ–¥–µ–ª–∏)
- **Feature-based:** `feature_max_tokens` (currently returns `None`)
- **Model capacity:** DeepSeek v3.2 (large context window)

**Message Limit:** 12 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

---

### Integration Points

**Bot Flow:**
```
bot.py ‚Üí services/chat_flow.py ‚Üí integrations/llm_client.py
```

**API Flow:**
```
api/routes_chat.py ‚Üí services/chat_flow.py ‚Üí integrations/llm_client.py
```

**Prompts:**
```
services/prompt_builder.py + services/llm_adapter.py
```

**Safety:**
```
services/safety.py (pattern-based pre-filtering)
```

**Intimacy:**
```
services/intimacy.py (rule-based gating)
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞)

### –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å

1. **Web App (miniapp/):**
   - ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã React
   - ‚úÖ –í—Å–µ —Ç–µ–∫—Å—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π!)
   - ‚úÖ Telegram WebApp –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
   - ‚úÖ API client
   - ‚úÖ Hooks
   - ‚úÖ –°—Ç–∏–ª–∏ –∏ –∞–Ω–∏–º–∞—Ü–∏–∏

2. **Backend API endpoints:**
   - ‚úÖ Personas CRUD
   - ‚úÖ Access/Store endpoints
   - ‚úÖ Features management
   - ‚úÖ Payment processing (Telegram Stars)

3. **Database models:**
   - ‚úÖ Personas (8 default + custom)
   - ‚úÖ Story cards (32+)
   - ‚úÖ User purchases
   - ‚úÖ Subscription status

4. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
   - ‚úÖ –ê–≤–∞—Ç–∞—Ä—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π (card + chat)
   - ‚úÖ –ü—Ä–µ–≤—å—é –∏—Å—Ç–æ—Ä–∏–π
   - ‚úÖ –í—Å–µ –∞—Å—Å–µ—Ç—ã –∏–∑ public/

### –ß—Ç–æ —É–ª—É—á—à–∏—Ç—å –≤ –Ω–æ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
   - –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—É–∂–µ –µ—Å—Ç—å)
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ frontend/backend
   - Docker compose setup

2. **Code quality:**
   - TypeScript strict mode
   - ESLint + Prettier
   - Unit tests (React Testing Library)
   - E2E tests (Playwright)

3. **Performance:**
   - React Query –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - Image optimization

4. **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å:**
   - i18n –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—É–∂–µ –µ—Å—Ç—å –≤ backend)
   - –†–∞—Å—à–∏—Ä–∏—Ç—å –Ω–∞ frontend (react-i18next)
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä—É—Å—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã –∫–∞–∫ default

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 2.0
**–î–∞—Ç–∞:** 2026-01-14
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù**
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `old_project/vitte-main copy/`

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- ‚úÖ Web App (miniapp) - –ø–æ–ª–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ React/TypeScript
- ‚úÖ –í—Å–µ —Ç–µ–∫—Å—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º (Web App + Telegram Bot)
- ‚úÖ Telegram Bot - –∫–æ–º–∞–Ω–¥—ã, –∫–Ω–æ–ø–∫–∏, —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ LLM Integration - DeepSeek v3.2, —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–ø—Ç–æ–≤, memory management
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π - 8 –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π + 32+ story cards —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏
- ‚úÖ Payment flow - Telegram Stars, —Ç–∞—Ä–∏—Ñ—ã, –æ–ø–∏—Å–∞–Ω–∏—è
- ‚úÖ Safety & Intimacy - –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, gates, fallbacks
